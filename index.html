<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>La Última Frontera</title>
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+DW+Pica&display=swap" rel="stylesheet">
  <style>
    :root {
      --background: #1e1e1e;
      --foreground: #f5f5f5;
      --accent: #d4af37;
      --muted: #aaaaaa;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'IM Fell DW Pica', serif;
      background-color: var(--background);
      color: var(--foreground);
      line-height: 1.6;
      padding: 1rem;
    }

    header {
      border-bottom: 1px solid var(--accent);
      margin-bottom: 2rem;
      padding-bottom: 1rem;
    }

    header h1 {
      font-size: 2.5rem;
      color: var(--accent);
    }

    nav a {
      margin-right: 1rem;
      text-decoration: none;
      color: var(--muted);
    }

    nav a:hover {
      color: var(--accent);
    }

    section {
      margin-bottom: 2rem;
    }

    h2 {
      color: var(--accent);
      margin-bottom: 0.5rem;
    }

    .book-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .book-item {
      border: 1px solid var(--accent);
      padding: 1rem;
      background-color: #2a2a2a;
      border-radius: 8px;
    }

    footer {
      border-top: 1px solid var(--accent);
      padding-top: 1rem;
      text-align: center;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <h1>La Última Frontera</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="archivo.html" class="active">Archivo</a>
      <a href="venta.html">Venta</a>
      <a href="blog.html">Blog</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>

  <section id="bienvenida">
    <h2>Bienvenida</h2>
    <p>
      La Última Frontera no es una librería, ni un archivo, ni un blog. Es un refugio para libros que importan,
      aunque ya nadie los busque. Cada libro aquí ha sido elegido con intención. Algunos están a la venta. Otros no.
      Este proyecto es personal y radicalmente íntimo. Bienvenide a la frontera.
    </p>
  </section>

  <!-- Formulario para agregar un libro con título, autor y precio -->
  <h2>Agregar libro</h2>
  <input type="text" id="inputTitulo" placeholder="Título del libro">
  <input type="text" id="inputAutor" placeholder="Autor del libro">
  <input type="number" id="inputPrecio" placeholder="Precio del libro" min="0">
  <button id="botonAgregarLibro">Agregar</button>

  <h2>Libros Agregados:</h2>
  <ul id="listaLibros">
    <!-- Los libros se mostrarán aquí -->
  </ul>

  <!-- Script de Firebase y lógica para agregar libros -->
  <script type="module">
    // Importar Firebase y la base de datos
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
    import { getDatabase, ref, push, set, onValue } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

    // Configuración de Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCu7RCPKPQbIkdG6OFYD6pIaMV4MfJBRg0",
      authDomain: "la-ultima-frontera.firebaseapp.com",
      databaseURL: "https://la-ultima-frontera-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "la-ultima-frontera",
      storageBucket: "la-ultima-frontera.firebasestorage.app",
      messagingSenderId: "802228739297",
      appId: "1:802228739297:web:f62a20578ec69912ee2ba0"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Función para agregar un libro
    function agregarLibro(titulo, autor, precio) {
      const librosRef = ref(database, 'libros');
      const nuevoLibroRef = push(librosRef);
      set(nuevoLibroRef, {
        titulo: titulo,
        autor: autor,
        precio: precio
      }).then(() => {
        alert("Libro agregado con éxito");

        // Limpiar los campos
        document.getElementById('inputTitulo').value = '';
        document.getElementById('inputAutor').value = '';
        document.getElementById('inputPrecio').value = '';
      }).catch((error) => {
        console.error("Error al agregar el libro:", error);
      });
    }

    // Agregar libro con el botón
    document.getElementById('botonAgregarLibro').addEventListener('click', () => {
      const titulo = document.getElementById('inputTitulo').value;
      const autor = document.getElementById('inputAutor').value;
      const precio = document.getElementById('inputPrecio').value;
      if (!titulo || !autor || !precio || isNaN(precio) || parseFloat(precio) <= 0) {
        alert('Por favor, ingrese título, autor y precio válidos.');
        return;
      }
      agregarLibro(titulo, autor, precio);
    });

    // Agregar libro presionando Enter
    document.getElementById('inputTitulo').addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        const titulo = document.getElementById('inputTitulo').value;
        const autor = document.getElementById('inputAutor').value;
        const precio = document.getElementById('inputPrecio').value;
        if (!titulo || !autor || !precio || isNaN(precio) || parseFloat(precio) <= 0) {
          alert('Por favor, ingrese título, autor y precio válidos.');
          return;
        }
        agregarLibro(titulo, autor, precio);
      }
    });

    document.getElementById('inputAutor').addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        const titulo = document.getElementById('inputTitulo').value;
        const autor = document.getElementById('inputAutor').value;
        const precio = document.getElementById('inputPrecio').value;
        if (!titulo || !autor || !precio || isNaN(precio) || parseFloat(precio) <= 0) {
          alert('Por favor, ingrese título, autor y precio válidos.');
          return;
        }
        agregarLibro(titulo, autor, precio);
      }
    });

    // Mostrar los libros en tiempo real
    const librosRef = ref(database, 'libros');

    // Escuchar los cambios en la base de datos (en tiempo real)
    onValue(librosRef, (snapshot) => {
      const libros = snapshot.val();
      const listaLibros = document.getElementById('listaLibros');
      listaLibros.innerHTML = '';  // Limpiar la lista antes de llenarla

      // Si no hay libros, mostramos un mensaje
      if (!libros) {
        listaLibros.innerHTML = "<li>No hay libros agregados aún.</li>";
        return;
      }

      // Iterar sobre los libros y agregarlos a la lista
      for (let id in libros) {
        const libro = libros[id];
        const li = document.createElement('li');
        
        // Crear un enlace a Google Books con el título
        const enlaceGoogleBooks = `https://books.google.com/?q=${encodeURIComponent(libro.titulo)}`;
        li.innerHTML = `<strong>${libro.titulo}</strong> de ${libro.autor} - Precio: ${libro.precio}€ - <a href="${enlaceGoogleBooks}" target="_blank">Ver en Google Books</a>`;
        
        // Añadir el libro a la lista
        listaLibros.appendChild(li);
      }
    });
  </script>

  <footer>
    <p>&copy; 2025 La Última Frontera. Proyecto independiente basado en una colección privada.</p>
  </footer>
</body>
</html>

